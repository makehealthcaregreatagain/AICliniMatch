<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AICliniMatch - Dashboard Prototype</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* Tailwind's gray-50 */
        }
        .screen {
            display: none;
        }
        .screen.active {
            display: block;
        }
        /* Custom scrollbar for aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #d1d5db; /* Tailwind's gray-300 */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #9ca3af; /* Tailwind's gray-400 */
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        #advanced-search-toggle .fa-chevron-down {
            transition: transform 0.3s ease-in-out;
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Main Application Wrapper -->
    <div class="min-h-screen flex flex-col">
        <!-- Header -->
        <header class="bg-white shadow-sm sticky top-0 z-50">
            <nav class="container mx-auto px-6 py-3 flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-blue-600 text-white flex items-center justify-center rounded-full">
                        <i class="fa-solid fa-share-nodes"></i>
                    </div>
                    <h1 class="text-xl font-bold text-gray-800">AICliniMatch</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <span class="text-sm text-gray-600 hidden sm:block">Dr. Anya Sharma</span>
                    <img src="https://placehold.co/40x40/E2E8F0/4A5568?text=AS" alt="User Avatar" class="w-10 h-10 rounded-full border-2 border-gray-200">
                </div>
            </nav>
        </header>

        <!-- Main Content Area -->
        <main class="flex-grow container mx-auto p-4 sm:p-6 lg:p-8">
            
            <!-- SCREEN 1: Search Dashboard -->
            <div id="screen-search" class="screen active animate-fade-in">
                <div class="text-center max-w-3xl mx-auto">
                    <h2 class="text-3xl sm:text-4xl font-bold text-gray-800">Find the right specialist, faster.</h2>
                    <p class="mt-4 text-lg text-gray-600">Search by condition, procedure, phenotype, or specialist name to find verified experts across the country.</p>
                    <div class="mt-8 flex rounded-lg shadow-lg overflow-hidden">
                        <input id="main-search-input" type="text" placeholder="e.g., “cystic fibrosis”" class="w-full px-6 py-4 text-lg border-0 focus:ring-2 focus:ring-blue-500 focus:outline-none">
                        <button onclick="performSearch()" class="bg-blue-600 text-white px-8 py-4 font-semibold hover:bg-blue-700 transition duration-300">
                            <i class="fa-solid fa-search mr-2"></i> Search
                        </button>
                    </div>

                    <!-- Advanced Search Toggle -->
                    <div class="text-center mt-4">
                        <a id="advanced-search-toggle" onclick="toggleAdvancedSearch()" class="text-blue-600 hover:underline cursor-pointer text-sm font-medium">
                            Advanced Search <i class="fa-solid fa-chevron-down text-xs ml-1"></i>
                        </a>
                    </div>

                    <!-- Advanced Search Form (hidden by default) -->
                    <div id="advanced-search-form" class="hidden mt-4 bg-gray-50 p-6 rounded-lg shadow-inner text-left">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="adv-location" class="block text-sm font-medium text-gray-700">Geography</label>
                                <input type="text" id="adv-location" placeholder="City, State, or Zip" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div>
                                <label for="adv-institution" class="block text-sm font-medium text-gray-700">Institution</label>
                                <input type="text" id="adv-institution" placeholder="e.g., 'Stanford Health Care'" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div class="md:col-span-2">
                                <label for="adv-trials" class="block text-sm font-medium text-gray-700">Clinical Trial Keywords</label>
                                <input type="text" id="adv-trials" placeholder="Search by keyword or NCT ID (e.g., 'immunotherapy', 'NCT04512345')" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                            </div>
                        </div>
                        <div class="mt-6 flex items-center justify-start space-x-6">
                            <label class="flex items-center text-sm font-medium text-gray-700">
                                <input type="checkbox" id="adv-telehealth" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                <span class="ml-2">Telehealth Available</span>
                            </label>
                            <label class="flex items-center text-sm font-medium text-gray-700">
                                <input type="checkbox" id="adv-accepting" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                <span class="ml-2">Accepting New Referrals</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="mt-6 text-sm text-gray-600 bg-gray-100 p-4 rounded-lg text-left">
                        <h3 class="font-semibold text-gray-700 mb-2">Recent Searches:</h3>
                        <p class="text-gray-500">
                            <a href="#" onclick="runDemoSearch('osteoradionecrosis')" class="text-blue-600 hover:underline">osteoradionecrosis</a>, 
                            <a href="#" onclick="runDemoSearch('huntington\'s disease')" class="text-blue-600 hover:underline">huntington's disease</a>, 
                            <a href="#" onclick="runDemoSearch('cystic fibrosis')" class="text-blue-600 hover:underline">cystic fibrosis</a>, 
                            <a href="#" onclick="runDemoSearch('ehlers-danlos syndrome')" class="text-blue-600 hover:underline">ehlers-danlos syndrome</a>
                        </p>
                    </div>
                </div>
            </div>

            <!-- SCREEN 2: Search Results -->
            <div id="screen-results" class="screen animate-fade-in">
                <div class="flex items-center mb-6">
                    <button onclick="showScreen('screen-search')" class="text-gray-500 hover:text-blue-600 mr-4 p-2 rounded-full hover:bg-gray-100"><i class="fa-solid fa-arrow-left"></i></button>
                    <h2 class="text-2xl font-bold">Results for: <span id="search-results-term" class="text-blue-600">""</span></h2>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
                    <!-- Filters Column -->
                    <aside class="lg:col-span-1 bg-white p-6 rounded-xl shadow-md h-fit">
                        <h3 class="font-bold text-lg mb-4">Filter Results</h3>
                        <!-- Location Filter -->
                        <div class="mb-6">
                            <label class="block font-semibold mb-2 text-sm">Location</label>
                            <input type="text" placeholder="City, State, or Zip" class="w-full p-2 border rounded-md text-sm">
                            <label class="flex items-center mt-2 text-sm"><input type="checkbox" class="mr-2"> Telehealth Available</label>
                        </div>
                        <!-- Insurance Filter -->
                        <div class="mb-6">
                            <label class="block font-semibold mb-2 text-sm">Insurance</label>
                            <select class="w-full p-2 border rounded-md text-sm">
                                <option>Aetna PPO</option>
                                <option>Blue Cross Blue Shield</option>
                                <option>Cigna</option>
                            </select>
                        </div>
                        <!-- Urgency Filter -->
                        <div>
                            <label class="block font-semibold mb-2 text-sm">Wait Time</label>
                            <select class="w-full p-2 border rounded-md text-sm">
                                <option>Any</option>
                                <option>Under 2 weeks</option>
                                <option>Under 1 month</option>
                                <option>1-3 months</option>
                            </select>
                        </div>
                    </aside>
                    <!-- Results List -->
                    <div id="results-list" class="lg:col-span-3 space-y-4">
                        <!-- Specialist cards are dynamically generated from JS, but I'll leave these here as a template -->
                        
                        <div id="no-results-message" class="hidden text-center py-10 bg-gray-50 rounded-lg">
                            <i class="fa-solid fa-magnifying-glass text-4xl text-gray-400"></i>
                            <h3 class="mt-4 text-xl font-semibold text-gray-700">No Specialists Found</h3>
                            <p class="mt-1 text-gray-500">Try adjusting your search term or filters.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SCREEN 3: Expert Profile -->
            <div id="screen-profile" class="screen animate-fade-in">
                 <div class="flex items-center mb-6">
                    <button onclick="showScreen('screen-results')" class="text-gray-500 hover:text-blue-600 mr-4 p-2 rounded-full hover:bg-gray-100"><i class="fa-solid fa-arrow-left"></i></button>
                    <h2 class="text-2xl font-bold">Specialist Profile</h2>
                </div>
                <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                    <!-- Profile Header -->
                    <div class="bg-blue-50 p-8 md:flex items-center space-x-8">
                        <img id="profile-img" src="" alt="Doctor" class="w-32 h-32 rounded-full border-4 border-white shadow-lg mx-auto md:mx-0">
                        <div>
                            <h3 id="profile-name" class="text-3xl font-bold mt-4 md:mt-0"></h3>
                            <p id="profile-subspecialty" class="text-blue-700 text-lg"></p>
                            <p id="profile-location" class="text-gray-600"></p>
                        </div>
                        <div id="profile-refer-button-container" class="md:ml-auto text-center mt-6 md:mt-0">
                             <!-- Button will be inserted here by JS -->
                        </div>
                    </div>
                    <!-- Profile Details -->
                    <div class="p-8 grid grid-cols-1 md:grid-cols-3 gap-8">
                        <div class="md:col-span-2">
                             <h4 class="font-bold text-xl mb-4 border-b pb-2">Areas of Expertise</h4>
                             <p id="profile-bio" class="text-gray-600 mb-4"></p>
                             <div id="profile-tags" class="flex flex-wrap gap-2"></div>
                             <h4 class="font-bold text-xl mb-4 border-b pb-2 mt-8">Ongoing Clinical Trials</h4>
                             <ul id="profile-trials" class="list-disc list-inside text-gray-600 space-y-2"></ul>
                        </div>
                        <div class="bg-gray-50 p-6 rounded-lg">
                            <h4 class="font-bold text-xl mb-4">Referral Information</h4>
                            <div class="space-y-4 text-sm">
                                <p><strong class="block text-gray-800">Accepted Referrals:</strong> <span id="referral-accepted"></span></p>
                                <p><strong class="block text-gray-800">Intake Protocol:</strong> <span id="referral-protocol"></span></p>
                                <p><strong class="block text-gray-800">Est. Wait Time:</strong> <span id="referral-wait_time" class="font-semibold text-red-600"></span></p>
                                <p><strong class="block text-gray-800">Contact:</strong> <span id="referral-contact"></span></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SCREEN 4: Referral Form -->
            <div id="screen-referral" class="screen animate-fade-in">
                <div class="flex items-center mb-6">
                    <button onclick="showScreen('screen-profile')" class="text-gray-500 hover:text-blue-600 mr-4 p-2 rounded-full hover:bg-gray-100"><i class="fa-solid fa-arrow-left"></i></button>
                    <h2 class="text-2xl font-bold">Create New Referral</h2>
                </div>
                <div class="max-w-4xl mx-auto bg-white p-8 rounded-xl shadow-lg">
                    <div class="grid grid-cols-2 gap-8 text-sm mb-8">
                        <p><strong>From:</strong><br>Dr. Anya Sharma<br>Palo Alto Primary Care</p>
                        <p><strong>To:</strong><br><span id="referral-to-name"></span><br><span id="referral-to-location"></span></p>
                    </div>
                    <div class="space-y-6">
                        <div>
                            <label class="font-semibold block mb-1">Patient Name</label>
                            <input type="text" placeholder="Enter patient name" class="w-full p-3 border rounded-md bg-gray-50">
                        </div>
                         <div>
                            <label class="font-semibold block mb-1">Reason for Referral</label>
                            <textarea class="w-full p-3 border rounded-md bg-gray-50 h-28" placeholder="Enter reason for referral..."></textarea>
                        </div>
                        <div>
                            <label class="font-semibold block mb-1">Attach Documents</label>
                            <div class="mt-2 border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                                <i class="fa-solid fa-cloud-arrow-up text-4xl text-gray-400"></i>
                                <p class="mt-2 text-gray-600">Drag & drop files here or <button class="text-blue-600 font-semibold hover:underline">browse</button></p>
                                <p class="text-xs text-gray-500 mt-1">Accepted: PDF, DOCX, JPG, PNG, DICOM</p>
                            </div>
                        </div>
                        <div class="text-right">
                             <button onclick="showScreen('screen-search')" class="w-full sm:w-auto bg-blue-600 text-white px-8 py-3 rounded-lg font-semibold text-lg hover:bg-blue-700 transition"><i class="fa-solid fa-lock mr-2"></i> Send Secure Referral</button>
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <script>
        const specialists = {
            // ... Osteoradionecrosis Specialists ...
            'vance': { name: 'Dr. Eleanor Vance, MD, PhD', img: 'https://placehold.co/80x80/93C5FD/3B82F6?text=EV', specialty: 'Head & Neck Surgical Oncology', location: 'Stanford Health Care, Palo Alto, CA', keywords: "oral cancer, jaw reconstruction, osteoradionecrosis, post-radiation mandibular osteomyelitis, stanford health care, palo alto, nct04512345, nct05876543, immunotherapy, imaging", telehealth: false, accepting: true, sub_specialty: 'Professor and Chair, Head & Neck Surgical Oncology', bio: 'Validated expertise in treating complex conditions of the head and neck, with a focus on post-treatment complications and quality of life.', tags: ['Osteoradionecrosis of the Mandible', 'Advanced Oral Cavity Cancer', 'Microvascular Reconstruction', 'Robotic Surgery (TORS)', 'Salivary Gland Tumors'], trials: [ { id: 'NCT04512345', desc: 'A Phase II study of immunotherapy in recurrent oral cancers.' }, { id: 'NCT05876543', desc: 'Novel imaging techniques for surgical margin assessment.' } ], referral_info: { accepted: 'Confirmed cases of mandibular osteoradionecrosis, complex post-radiation defects.', protocol: 'Please include recent imaging (CT/MRI reports) and pathology reports with referral packet.', wait_time: '4-6 weeks', contact: '650-555-1234 (Clinic Coordinator)' } },
            'tanaka': { name: 'Dr. Kenji Tanaka, DDS', img: 'https://placehold.co/80x80/FCA5A5/991B1B?text=KT', specialty: 'Oral & Maxillofacial Surgery', location: 'MD Anderson Cancer Center, Houston, TX', keywords: "osteoradionecrosis, oral surgery, md anderson cancer center, houston, nct06010203, hyperbaric", telehealth: false, accepting: true, sub_specialty: 'Oral & Maxillofacial Surgery', bio: 'Dedicated to the surgical management of oral cancers and complications from cancer therapy, including osteoradionecrosis.', tags: ['Osteoradionecrosis', 'Dental Oncology', 'Head and Neck Cancer Survivorship'], trials: [ { id: 'NCT06010203', desc: 'Trial using hyperbaric oxygen therapy for severe osteoradionecrosis.' } ], referral_info: { accepted: 'Patients with oral complications from radiation therapy or chemotherapy.', protocol: 'Oncology summary and radiation treatment plan must be provided.', wait_time: '2-3 weeks', contact: '713-555-8765 (Surgery Center)' } },
            'garcia': { name: 'Dr. Maria Garcia, MD', img: 'https://placehold.co/80x80/BEF264/3F6212?text=MG', specialty: 'Radiation Oncology', location: 'Duke University Hospital, Durham, NC', keywords: "osteoradionecrosis, radiation oncology, duke university hospital, durham", telehealth: true, accepting: true, sub_specialty: 'Radiation Oncology', bio: 'Focuses on minimizing and managing side effects of radiation therapy for head and neck cancers, including ORN.', tags: ['Osteoradionecrosis', 'Radiation Side Effect Management', 'IMRT'], trials: [], referral_info: { accepted: 'Patients with post-radiation complications.', protocol: 'Via Duke Health provider portal.', wait_time: '3-4 weeks', contact: '919-555-1111' } },
            'samuel_lee': { name: 'Dr. Samuel Lee, DMD', img: 'https://placehold.co/80x80/A5F3FC/0E7490?text=SL', specialty: 'Prosthodontics', location: 'University of Michigan, Ann Arbor, MI', keywords: "osteoradionecrosis, prosthodontics, university of michigan, ann arbor", telehealth: false, accepting: true, sub_specialty: 'Prosthodontics', bio: 'Specializes in the prosthetic rehabilitation of patients with complex jaw defects resulting from surgery or radiation.', tags: ['Osteoradionecrosis', 'Maxillofacial Prosthetics', 'Dental Implants'], trials: [], referral_info: { accepted: 'Patients requiring prosthetic jaw reconstruction.', protocol: 'Dental records and imaging required.', wait_time: '5-7 weeks', contact: '734-555-2222' } },
            
            // ... Huntington's Disease Specialists ...
            'thorne': { name: 'Dr. Marcus Thorne, MD', img: 'https://placehold.co/80x80/FDBA74/C2410C?text=MT', specialty: 'Movement Disorders Neurology', location: 'Johns Hopkins Hospital, Baltimore, MD', keywords: "huntington's disease, parkinson's, dystonia, neurology, johns hopkins hospital, baltimore, nct06123456, gene therapy", telehealth: true, accepting: true, sub_specialty: 'Director, Movement Disorders Center', bio: 'Leading expert in the diagnosis and management of Huntington\'s disease and other neurodegenerative movement disorders.', tags: ["Huntington's Disease", "Parkinson's Disease", "Dystonia", "Deep Brain Stimulation"], trials: [ { id: 'NCT06123456', desc: 'Gene therapy trial for early-stage Huntington\'s disease.' } ], referral_info: { accepted: 'Genetically confirmed Huntington\'s disease, complex Parkinsonism.', protocol: 'Genetic test results must be included in referral packet.', wait_time: '2-3 weeks', contact: '410-555-9876 (Neurology Intake)' } },
            'carter': { name: 'Dr. Ben Carter, PhD', img: 'https://placehold.co/80x80/C4B5FD/5B21B6?text=BC', specialty: 'Neurogenetics', location: 'Cleveland Clinic, Cleveland, OH', keywords: "huntington's disease, neurology, cleveland clinic, cleveland, genetic counseling", telehealth: true, accepting: true, sub_specialty: 'Neurogenetics', bio: 'Clinical researcher and genetic counselor specializing in adult-onset neurogenetic disorders, particularly Huntington\'s disease and hereditary ataxias.', tags: ['Huntington\'s Disease', 'Spinocerebellar Ataxia', 'Genetic Counseling', 'Predictive Testing'], trials: [], referral_info: { accepted: 'Patients with a family history of Huntington\'s for counseling and testing.', protocol: 'Referral from a primary neurologist is preferred.', wait_time: '2-4 weeks', contact: '216-555-5432 (Genomic Medicine Institute)' } },
            'rodriguez': { name: 'Dr. Olivia Rodriguez, MD', img: 'https://placehold.co/80x80/FDA4AF/881337?text=OR', specialty: 'Neurology', location: 'UCLA Medical Center, Los Angeles, CA', keywords: "huntington's disease, neurology, ucla medical center, los angeles, clinical trials", telehealth: true, accepting: false, sub_specialty: 'Neurology', bio: 'Principal investigator for several leading clinical trials targeting the progression of Huntington\'s disease.', tags: ["Huntington's Disease", 'Clinical Trials', 'Neurodegenerative Disease'], trials: [{id: 'NCT07123456', desc: 'A study on a novel small molecule for HD symptom management.'}], referral_info: { accepted: 'Only for clinical trial enrollment.', protocol: 'Contact trial coordinator.', wait_time: 'Varies', contact: '310-555-3333' } },
            'david_chen': { name: 'Dr. David Chen, MD, PhD', img: 'https://placehold.co/80x80/99F6E4/0D9488?text=DC', specialty: 'Neuropsychiatry', location: 'Massachusetts General Hospital, Boston, MA', keywords: "huntington's disease, psychiatry, massachusetts general hospital, boston", telehealth: true, accepting: true, sub_specialty: 'Neuropsychiatry', bio: 'Specializes in the psychiatric and cognitive symptoms associated with Huntington\'s disease, including depression and apathy.', tags: ["Huntington's Disease", 'Cognitive Decline', 'Neuropsychiatry'], trials: [], referral_info: { accepted: 'HD patients with significant behavioral or cognitive symptoms.', protocol: 'Standard hospital referral.', wait_time: '4-6 weeks', contact: '617-555-4444' } },

            // ... Cystic Fibrosis Specialists ...
            'petrova': { name: 'Dr. Lena Petrova, MD', img: 'https://placehold.co/80x80/86EFAC/15803D?text=LP', specialty: 'Adult Cystic Fibrosis Program', location: 'National Jewish Health, Denver, CO', keywords: "cystic fibrosis, bronchiectasis, mucus clearance, pulmonology, national jewish health, denver, nct05554321, modulator", telehealth: true, accepting: true, sub_specialty: 'Co-Director, Adult Cystic Fibrosis Program', bio: 'Focuses on managing adult patients with Cystic Fibrosis, including advanced lung disease and post-transplant care.', tags: ['Cystic Fibrosis', 'Bronchiectasis', 'Mucus Clearance Therapies', 'Lung Transplant Evaluation'], trials: [ { id: 'NCT05554321', desc: 'Study of novel modulator therapies in CF patients with rare mutations.' } ], referral_info: { accepted: 'Adults (18+) with confirmed diagnosis of Cystic Fibrosis.', protocol: 'Sweat chloride test and mutation analysis required.', wait_time: '1-2 weeks', contact: '303-555-1122 (CF Clinic Navigator)' } },
            'khan': { name: 'Dr. Aisha Khan, MD', img: 'https://placehold.co/80x80/67E8F9/0E7490?text=AK', specialty: 'Pediatric Pulmonology', location: 'Boston Children\'s Hospital, Boston, MA', keywords: "cystic fibrosis, pediatric pulmonology, boston children's hospital, boston, nct05998877, asthma", telehealth: true, accepting: true, sub_specialty: 'Pediatric Pulmonology', bio: 'Focuses on complex respiratory diseases in children, with a primary research interest in Cystic Fibrosis and non-invasive ventilation.', tags: ['Cystic Fibrosis (Pediatric)', 'Primary Ciliary Dyskinesia', 'Severe Asthma'], trials: [ { id: 'NCT05998877', desc: 'A study on the efficacy of a new inhaled antibiotic for children with CF.' } ], referral_info: { accepted: 'Children and adolescents up to age 21 with complex lung diseases.', protocol: 'Via Epic referrals from pediatric primary care providers.', wait_time: '3-5 weeks', contact: '617-555-6789 (Pulmonology Front Desk)' } },
            'michael_brown': { name: 'Dr. Michael Brown, MD', img: 'https://placehold.co/80x80/FDE68A/854D0E?text=MB', specialty: 'Pulmonology & Gastroenterology', location: 'Emory University Hospital, Atlanta, GA', keywords: "cystic fibrosis, gastroenterology, emory university hospital, atlanta", telehealth: true, accepting: true, sub_specialty: 'Pulmonology & Gastroenterology', bio: 'Dual-specialist focusing on both the pulmonary and gastrointestinal manifestations of adult Cystic Fibrosis.', tags: ['Cystic Fibrosis', 'Pancreatic Insufficiency', 'CF-related Diabetes'], trials: [], referral_info: { accepted: 'Adult CF patients, especially those with complex GI issues.', protocol: 'Standard referral.', wait_time: '2-4 weeks', contact: '404-555-5555' } },
            'williams': { name: 'Dr. Sophia Williams, MD', img: 'https://placehold.co/80x80/D8B4FE/581C87?text=SW', specialty: 'Pulmonology', location: 'UT Southwestern Medical Center, Dallas, TX', keywords: "cystic fibrosis, pulmonology, ut southwestern, dallas", telehealth: true, accepting: true, sub_specialty: 'Pulmonology', bio: 'Expert in emerging modulator therapies and personalized medicine approaches for Cystic Fibrosis.', tags: ['Cystic Fibrosis', 'Modulator Therapies', 'Personalized Medicine'], trials: [], referral_info: { accepted: 'All adult CF patients.', protocol: 'Referral with genetic testing results.', wait_time: '3-4 weeks', contact: '214-555-6666' } },

            // ... Ehlers-Danlos Syndrome Specialists ...
            'diaz': { name: 'Dr. Samuel Diaz, MD', img: 'https://placehold.co/80x80/F9A8D4/9D266A?text=SD', specialty: 'Connective Tissue Disorders Clinic', location: 'Mayo Clinic, Rochester, MN', keywords: "ehlers-danlos syndrome, marfan syndrome, genetics, connective tissue, mayo clinic, rochester", telehealth: false, accepting: false, sub_specialty: 'Connective Tissue Disorders Clinic', bio: 'Specializes in the diagnosis and multidisciplinary management of hereditary connective tissue disorders like Ehlers-Danlos and Marfan syndrome.', tags: ['Ehlers-Danlos Syndrome', 'Marfan Syndrome', 'Loeys-Dietz syndrome', 'Genetic Aortopathies'], trials: [], referral_info: { accepted: 'Referrals for suspected or confirmed hereditary connective tissue disorders.', protocol: 'Extensive family history and any genetic testing results are required.', wait_time: '3-4 months', contact: '507-555-0123 (Genetics Dept.)' } },
            'martinez': { name: 'Dr. Isabella Martinez, MD', img: 'https://placehold.co/80x80/A78BFA/4C1D95?text=IM', specialty: 'Rheumatology', location: 'Johns Hopkins Hospital, Baltimore, MD', keywords: "ehlers-danlos syndrome, rheumatology, johns hopkins hospital, baltimore, hypermobility", telehealth: true, accepting: true, sub_specialty: 'Rheumatology', bio: 'Focuses on the musculoskeletal and chronic pain aspects of hypermobile Ehlers-Danlos syndrome (hEDS).', tags: ['Ehlers-Danlos Syndrome', 'Hypermobility Spectrum Disorders', 'Chronic Pain'], trials: [], referral_info: { accepted: 'Patients with hypermobility-related joint pain.', protocol: 'Requires a prior rheumatology workup.', wait_time: '6-8 weeks', contact: '410-555-7777' } },
            'johnson': { name: 'Dr. Noah Johnson, MD', img: 'https://placehold.co/80x80/7DD3FC/0369A1?text=NJ', specialty: 'Cardiology', location: 'Vanderbilt University Medical Center, Nashville, TN', keywords: "ehlers-danlos syndrome, cardiology, vanderbilt, nashville, vascular", telehealth: false, accepting: true, sub_specialty: 'Cardiology', bio: 'Specialist in the cardiovascular manifestations of connective tissue disorders, particularly vascular Ehlers-Danlos syndrome (vEDS).', tags: ['Ehlers-Danlos Syndrome (vEDS)', 'Aortic Dissection', 'Marfan Syndrome'], trials: [], referral_info: { accepted: 'Patients with confirmed or suspected vEDS.', protocol: 'Genetic test results are mandatory.', wait_time: '2-3 weeks', contact: '615-555-8888' } },
            
            // ... Other Specialists for Variety ...
            'chen': { name: 'Dr. Jian Chen, MD', img: 'https://placehold.co/80x80/A5B4FC/4338CA?text=JC', specialty: 'Reconstructive Microsurgery', location: 'UCSF Medical Center, San Francisco, CA', keywords: "maxillofacial trauma, head & neck reconstruction, ucsf medical center, san francisco", telehealth: false, accepting: false, sub_specialty: 'Professor, Reconstructive Microsurgery', bio: 'Specializes in complex reconstructions following major trauma or cancer resection in the head and neck region.', tags: ['Maxillofacial Trauma', 'Head & Neck Reconstruction', 'Free Flap Surgery'], trials: [], referral_info: { accepted: 'Complex facial trauma, patients requiring microsurgical reconstruction.', protocol: 'Referrals accepted through UCSF provider portal.', wait_time: '8-10 weeks (waitlisted)', contact: '415-555-5678 (Surgical Coordinator)' } }
        };

        function createSpecialistCard(id, data) {
            const statusSpan = data.accepting 
                ? `<span class="text-sm bg-green-100 text-green-800 font-medium px-2 py-1 rounded-full">Accepting Referrals</span>`
                : `<span class="text-sm ${data.referral_info.wait_time.toLowerCase().includes('waitlist') ? 'bg-yellow-100 text-yellow-800' : 'bg-red-100 text-red-800'} font-medium px-2 py-1 rounded-full">${data.referral_info.wait_time.toLowerCase().includes('waitlist') ? 'Waitlist' : 'Not Accepting'}</span>`;

            const referButton = data.accepting
                ? `<button onclick="showProfile('${id}')" class="bg-blue-600 text-white px-4 py-2 h-fit self-center rounded-lg font-semibold hover:bg-blue-700 transition">View & Refer</button>`
                : `<button class="bg-gray-400 text-white px-4 py-2 h-fit self-center rounded-lg font-semibold cursor-not-allowed">View Profile</button>`;

            let tagsHTML = '';
            if(data.tags && data.tags.length > 0) {
                 const primaryTag = data.tags[0];
                 tagsHTML += `<span class="inline-block bg-blue-100 border border-blue-300 rounded-full px-3 py-1 text-sm font-semibold text-blue-800 mr-2 mb-2">${primaryTag}</span>`;
                 if(data.tags.length > 1) {
                    tagsHTML += `<span class="inline-block bg-gray-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2">${data.tags[1]}</span>`;
                 }
            }

            return `
                <div class="specialist-card bg-white p-6 rounded-xl shadow-md hover:shadow-xl hover:scale-[1.01] transition-all duration-300 flex items-start space-x-6" data-keywords="${data.keywords}" data-telehealth="${data.telehealth}" data-accepting="${data.accepting}">
                    <img src="${data.img}" alt="${data.name}" class="w-20 h-20 rounded-full border-4 border-white shadow-sm">
                    <div class="flex-grow">
                        <div class="flex justify-between items-center">
                            <h4 class="text-xl font-bold">${data.name}</h4>
                            ${statusSpan}
                        </div>
                        <p class="text-blue-700">${data.specialty}</p>
                        <p class="text-gray-600 text-sm mt-1"><i class="fa-solid fa-hospital mr-2"></i>${data.location}</p>
                        <div class="mt-3">
                            ${tagsHTML}
                        </div>
                    </div>
                    ${referButton}
                </div>
            `;
        }

        function populateSpecialistCards() {
            const container = document.getElementById('results-list');
            // Clear existing cards except for the 'no results' message
            container.innerHTML = `
                <div id="no-results-message" class="hidden text-center py-10 bg-gray-50 rounded-lg">
                    <i class="fa-solid fa-magnifying-glass text-4xl text-gray-400"></i>
                    <h3 class="mt-4 text-xl font-semibold text-gray-700">No Specialists Found</h3>
                    <p class="mt-1 text-gray-500">Try adjusting your search term or filters.</p>
                </div>`;

            for (const id in specialists) {
                const cardHTML = createSpecialistCard(id, specialists[id]);
                container.insertAdjacentHTML('beforeend', cardHTML);
            }
        }


        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => screen.classList.remove('active'));
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                targetScreen.classList.add('active');
                window.scrollTo(0, 0);
            }
        }

        function toggleAdvancedSearch() {
            const form = document.getElementById('advanced-search-form');
            const toggleIcon = document.querySelector('#advanced-search-toggle i');
            form.classList.toggle('hidden');
            if (form.classList.contains('hidden')) {
                toggleIcon.classList.remove('rotate-180');
            } else {
                toggleIcon.classList.add('rotate-180');
            }
        }

        function performSearch() {
            // Read from all search fields
            const searchTerm = document.getElementById('main-search-input').value.toLowerCase().trim();
            const locationTerm = document.getElementById('adv-location').value.toLowerCase().trim();
            const institutionTerm = document.getElementById('adv-institution').value.toLowerCase().trim();
            const trialsTerm = document.getElementById('adv-trials').value.toLowerCase().trim();
            const telehealthChecked = document.getElementById('adv-telehealth').checked;
            const acceptingChecked = document.getElementById('adv-accepting').checked;
            
            document.getElementById('search-results-term').textContent = `"${searchTerm || 'All Specialists'}"`;
            
            const specialistCards = document.querySelectorAll('.specialist-card');
            let resultsFound = false;

            specialistCards.forEach(card => {
                const keywords = card.getAttribute('data-keywords').toLowerCase();
                const telehealth = card.getAttribute('data-telehealth') === 'true';
                const accepting = card.getAttribute('data-accepting') === 'true';

                // Check each condition
                const mainMatch = !searchTerm || keywords.includes(searchTerm);
                const locationMatch = !locationTerm || keywords.includes(locationTerm);
                const institutionMatch = !institutionTerm || keywords.includes(institutionTerm);
                const trialsMatch = !trialsTerm || keywords.includes(trialsTerm);
                const telehealthMatch = !telehealthChecked || telehealth;
                const acceptingMatch = !acceptingChecked || accepting;

                // Show card if all conditions are met
                if (mainMatch && locationMatch && institutionMatch && trialsMatch && telehealthMatch && acceptingMatch) {
                    card.style.display = 'flex';
                    resultsFound = true;
                } else {
                    card.style.display = 'none';
                }
            });

            document.getElementById('no-results-message').style.display = resultsFound ? 'none' : 'block';
            showScreen('screen-results');
        }

        function runDemoSearch(term) {
            document.getElementById('main-search-input').value = term;
            // Clear advanced fields for demo clicks
            document.getElementById('adv-location').value = '';
            document.getElementById('adv-institution').value = '';
            document.getElementById('adv-trials').value = '';
            document.getElementById('adv-telehealth').checked = false;
            document.getElementById('adv-accepting').checked = false;
            performSearch();
        }

        function showProfile(specialistId) {
            const data = specialists[specialistId];
            if (!data) return;

            // Populate profile header
            document.getElementById('profile-img').src = data.img;
            document.getElementById('profile-name').textContent = data.name;
            document.getElementById('profile-subspecialty').textContent = data.sub_specialty;
            document.getElementById('profile-location').innerHTML = `<i class="fa-solid fa-hospital mr-2"></i>${data.location}`;
            
            // Populate referral form info
            document.getElementById('referral-to-name').textContent = data.name;
            document.getElementById('referral-to-location').textContent = data.location;
            
            // Populate refer button
            const referButtonContainer = document.getElementById('profile-refer-button-container');
            if(data.accepting) {
                 referButtonContainer.innerHTML = `<button onclick="showScreen('screen-referral')" class="w-full bg-blue-600 text-white px-8 py-3 rounded-lg font-semibold text-lg hover:bg-blue-700 transition"><i class="fa-solid fa-paper-plane mr-2"></i> Initiate Referral</button>`;
            } else {
                 referButtonContainer.innerHTML = `<button class="w-full bg-gray-400 text-white px-8 py-3 rounded-lg font-semibold text-lg cursor-not-allowed"><i class="fa-solid fa-times-circle mr-2"></i> Not Accepting Referrals</button>`;
            }

            // Populate profile details
            document.getElementById('profile-bio').textContent = data.bio;
            
            const tagsContainer = document.getElementById('profile-tags');
            tagsContainer.innerHTML = '';
            data.tags.forEach((tag, index) => {
                const isPrimary = index === 0;
                const tagEl = document.createElement('span');
                tagEl.className = `${isPrimary ? 'bg-blue-100 border border-blue-300 text-blue-800' : 'bg-gray-200 text-gray-800'} px-3 py-1 rounded-full font-medium`;
                tagEl.textContent = tag;
                tagsContainer.appendChild(tagEl);
            });

            const trialsContainer = document.getElementById('profile-trials');
            trialsContainer.innerHTML = '';
            if (data.trials.length > 0) {
                data.trials.forEach(trial => {
                    const trialEl = document.createElement('li');
                    trialEl.innerHTML = `<span class="font-semibold text-gray-800">${trial.id}:</span> ${trial.desc}`;
                    trialsContainer.appendChild(trialEl);
                });
            } else {
                trialsContainer.innerHTML = '<li>No active clinical trials listed.</li>';
            }

            // Populate referral info box
            document.getElementById('referral-accepted').textContent = data.referral_info.accepted;
            document.getElementById('referral-protocol').textContent = data.referral_info.protocol;
            document.getElementById('referral-wait_time').textContent = data.referral_info.wait_time;
            document.getElementById('referral-contact').textContent = data.referral_info.contact;

            showScreen('screen-profile');
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', () => {
            populateSpecialistCards();
            showScreen('screen-search');
        });
    </script>

</body>
</html>

